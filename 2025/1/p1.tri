import "trilogy:debug" use dbg
import "trilogy:io" use readlines
import "trilogy:parsec" use parse, char_of, integer, apply
import "trilogy:iterator" as it

proc rotation!() {
  let dir = apply <| char_of "LR"
  let amt = apply integer
  return if dir == 'R' then amt else -amt
}

func rotate pos amt = (pos + amt) % 100

proc main!() {
  let answer = readlines
    |> it::map (parse rotation)
    |> it::scanl rotate 50
    |> it::filter ((==) 0)
    |> it::count
  dbg!(answer)
}
